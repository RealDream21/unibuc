CREATE TABLE STRADA(
    id_strada NUMBER(3) PRIMARY KEY,
    nume_strada VARCHAR(100) NOT NULL
    );
    
CREATE TABLE INSTITUTIE_INVATAMANT (
    id_forma NUMBER(3) PRIMARY KEY,
    nume VARCHAR(50) NOT NULL,
    tip_forma_invatamant CHAR(40) NOT NULL,
    id_strada REFERENCES STRADA
    );

CREATE TABLE CASA (
    id_strada REFERENCES STRADA,
    numar NUMBER(3) NOT NULL CHECK (numar > 0 AND numar < 50),
    camere NUMBER(2) DEFAULT 1 NOT NULL,
    dimensiune NUMBER(4) NOT NULL,
    PRIMARY KEY(id_strada, numar)
    );

CREATE TABLE PRIMARIE (
    id_primarie NUMBER(3) PRIMARY KEY,
    nume VARCHAR(100) NOT NULL,
    id_strada REFERENCES STRADA,
    CONSTRAINT primarie_locatie_unic UNIQUE (id_strada)
    );

CREATE TABLE FAMILIE(
    id_familie NUMBER(4) PRIMARY KEY,
    id_primarie REFERENCES PRIMARIE,
    nume_familie VARCHAR(25) NOT NULL
    );

CREATE TABLE LOCUITOR (
    id_locuitor NUMBER(5) PRIMARY KEY,
    id_familie NUMBER(4) REFERENCES FAMILIE(id_familie),
    prenume VARCHAR(50) NOT NULL,
    sex NUMBER(1) CHECK (sex > 0 AND sex < 3)
    );

CREATE TABLE FIRMA_ORGANIZARE(
    id_firma NUMBER(3) PRIMARY KEY,
    nume VARCHAR(100) NOT NULL
    );
    
CREATE TABLE EVENIMENT_CULTURAL(
    id_eveniment NUMBER(3) PRIMARY KEY, 
    id_firma REFERENCES FIRMA_ORGANIZARE,
    nume_eveniment VARCHAR(25) NOT NULL,
    capacitate NUMBER(7) NOT NULL
    );

CREATE TABLE CUMPARATOR(
    id_cumparator NUMBER(3) PRIMARY KEY,
    nume VARCHAR(100) NOT NULL
    );

CREATE TABLE CICLU_INVATAMANT(
    id_forma REFERENCES INSTITUTIE_INVATAMANT,
    id_locuitor REFERENCES locuitor,
    an_invatamant DATE NOT NULL,
    PRIMARY KEY (id_forma, id_locuitor, an_invatamant)
    );
    
CREATE TABLE CONTRACT_CUMPARARE(
    id_primarie REFERENCES PRIMARIE,
    id_cumparator REFERENCES CUMPARATOR,
    id_familie REFERENCES FAMILIE,
    data_cumparare DATE NOT NULL,
    taxa NUMBER(3) DEFAULT NULL,
    suma NUMBER(8) NOT NULL,
    PRIMARY KEY (id_primarie, id_cumparator, id_familie, data_cumparare)
    );

CREATE TABLE FAMILIE_CASA(
    id_familie NUMBER(4) NOT NULL,
    id_strada NUMBER(3),
    numar NUMBER(3),
    data_mutare DATE NOT NULL,
    PRIMARY KEY (id_familie, id_strada, numar, data_mutare),
    FOREIGN KEY (id_strada, numar) REFERENCES CASA(id_strada, numar),
    FOREIGN KEY (id_familie) REFERENCES FAMILIE(id_familie)
    );

CREATE TABLE PRIMARIE_EVENIMENT(
    id_primarie REFERENCES PRIMARIE,
    id_eveniment REFERENCES EVENIMENT_CULTURAL,
    data_eveniment DATE NOT NULL,
    PRIMARY KEY(id_primarie, id_eveniment, data_eveniment)
    );